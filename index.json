[{"content":"","date":"November 28, 2021","permalink":"/","section":"Aditya's blog","summary":"","title":"Aditya's blog"},{"content":"","date":"November 28, 2021","permalink":"/blog/","section":"Blogs","summary":"","title":"Blogs"},{"content":" My favorite way of writing an e2e test for my UI is using cypress. Cypress makes things very simple and easy to write tests with.\nThe problem I found with writing tests with cypress is that it takes too long for the test to complete. This in turn creates friction for new developers to do a full-blown e2e test run. Cypress running for 40 mins\nThe fix to ensure we run all our tests regularly to run the test in parallel. Thankfully Jenkins (or any modern CI ) supports running tasks in parallel (https://www.jenkins.io/blog/2017/09/25/declarative-1/).\nstage(\u0026#39;run test\u0026#39;) { parallel { stage(\u0026#39;tester A\u0026#39;) { steps { sh \u0026#34;npm run cy:run:parallel\u0026#34; } } // second tester runs the same command stage(\u0026#39;tester B\u0026#39;) { steps { sh \u0026#34;npm run cy:run:parallel\u0026#34; } } // third tester runs the same command stage(\u0026#39;tester C\u0026#39;) { steps { sh \u0026#34;npm run cy:run:parallel\u0026#34; } } // fourth tester runs the same command stage(\u0026#39;tester D\u0026#39;) { steps { sh \u0026#34;npm run cy:run:parallel\u0026#34; } } } The code above will ensure the tests are run in parallel. Cypress io offers a bunch of plans including a free plan to record the test. The reason why we need to record the test is that cypress takes over the process of dividing the test for each machine.\nAfter doing this change, our tests now run in less than 12mins (from earlier 40mins).\nDue to security concerns, I decided that it’s better to host the dashboard instead of using cypress io. The dashboard will help us run tests in parallel.\nI came across this project Sorry Cypress project which is an open-source alternative to cypress.io paid dashboard. The project was simple to set up since all it involves is running docker-compose up ( Since we are on Kubernetes I had to use kompose to convert docker compose to a helm chart)\nOnce I had it up and running, all I had to do is to change cypress API path to point to the sorry cypress instance Sorry Cypress dashboard Failed Test screenshot\ndef CYPRESS_VERSION=\u0026#34;\\$(npm show cypress version)\u0026#34;def CYPRESS_CONFIG_FILE_PATH=\u0026#34;\\$(npx cypress cache path)/${CYPRESS_VERSION}/Cypress/resources/app/packages/server/config/app.yml\u0026#34; sh \u0026#34;sed -i \u0026#39;s/https:\\\\/\\\\/api.cypress.io\\\\//https:\\\\/\\\\/sorry-cy.internal.adityat.com/g\u0026#39; $CYPRESS_CONFIG_FILE_PATH\u0026#34; I used this as step 1 of the Build process, right after I do npm install. This will point cypress instance running on Jenkins to the internally hosted cypress dashboard.\nTo group your tests you can change the CI build command to below, so your test will appear as “master-1”, “master-2”\nsh \u0026#34;npm run cy:run:parallel -- --ci-build-id ${env.BRANCH_NAME}-${env.BUILD_ID}\u0026#34; One thing that may not work with parallelization is the ability to report code coverage.\n","date":"November 28, 2021","permalink":"/blog/cypress-jenkins/","section":"Blogs","summary":"My favorite way of writing an e2e test for my UI is using cypress.","title":"Cypress Parallelization on Jenkins using Sorry-Cypress"},{"content":"My name is Aditya Trivedi. I am a highly-skilled and motivated senior software engineer with 9 years of experience. I enjoy writing in JS/TS with React and Node.js. Solution-focused, data-driven and customer-obsessed. Delivered software projects in four countries impacting 100M+ customers.\nResume\n","date":"August 14, 2021","permalink":"/about-me/","section":"Aditya's blog","summary":"My name is Aditya Trivedi.","title":"About me"},{"content":"","date":"August 14, 2021","permalink":"/tags/sample/","section":"Tags","summary":"","title":"sample"},{"content":"","date":"August 14, 2021","permalink":"/tags/","section":"Tags","summary":"","title":"Tags"},{"content":"","date":"August 14, 2021","permalink":"/tags/users/","section":"Tags","summary":"","title":"users"},{"content":"","date":"January 1, 1","permalink":"/categories/","section":"Categories","summary":"","title":"Categories"}]